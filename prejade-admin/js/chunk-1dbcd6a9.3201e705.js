(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1dbcd6a9"],{3323:function(e,t,a){"use strict";a("a9e3");t["a"]={props:{id:{require:!0,type:Number},show:{require:!0,type:Boolean}},computed:{showVal:{get:function(){return this.show},set:function(e){this.$emit("update:show",e)}}}}},3659:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tree",{ref:"tree",attrs:{props:e.props,data:e.data,"default-expand-all":"","show-checkbox":e.showCheckbox,"check-strictly":!0,"node-key":"name"},on:{check:e.handleCheckChange,"node-click":e.handleNodeClick}})},n=[],s=(a("4160"),a("b0c0"),a("159b"),a("3323")),o=a("77a4"),r={name:"PrivilegeTree",mixins:[s["a"]],props:{value:{require:!0,type:[Array,Object],default:function(){return[]}},showCheckbox:{require:!1,type:Boolean,default:function(){return!0}}},data:function(){return{props:{label:"label",children:"children"},count:1,data:[]}},computed:{idVal:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;Object(o["e"])().then((function(t){e.data=t.data,e.refreshChecked()}))},refreshChecked:function(){this.idVal&&this.idVal.length>0&&this.$refs.tree.setCheckedKeys(this.idVal)},handleCheckChange:function(e,t,a){this.idVal=this.getCheckedKeys()},handleNodeClick:function(e,t,a){this.$emit("node-click",e,t,a)},setCheckedKeys:function(e){this.$refs.tree.setCheckedKeys(e)},getCheckedKeys:function(){var e=this.$refs.tree.getCheckedNodes(!1,!0),t=[];return e.forEach((function(e){t.push(e.name)})),t}}},l=r,c=a("2877"),d=Object(c["a"])(l,i,n,!1,null,"5db822d0",null);t["a"]=d.exports},"77a4":function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var i=a("b775"),n=function(e){return Object(i["a"])({url:"/sys/permission/tree",method:"get",data:e})},s=function(e){var t=e.id,a=e.data;return Object(i["a"])({url:"/sys/permission/".concat(t),method:"post",data:a})},o=function(e){var t=e.data;return Object(i["a"])({url:"/sys/permission",method:"post",data:t})},r=function(e){return Object(i["a"])({url:"/sys/permission/"+e,method:"get"})},l=function(e){return Object(i["a"])({url:"/sys/permission/findByName",method:"get",params:{name:e}})},c=function(e){return Object(i["a"])({url:"/sys/permission/"+e,method:"delete"})}},a4e7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.initData}},[e._v("查询 ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.add}},[e._v("新增 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.data,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"编号",width:"70",prop:"id",align:"center"}}),a("el-table-column",{attrs:{label:"名称",prop:"label"}}),a("el-table-column",{attrs:{label:"编码",prop:"name"}}),a("el-table-column",{attrs:{"header-align":"center",align:"center",width:"225","class-name":"operate-group",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.edit(t.row.id)}}}),a("el-button",{staticClass:"del-btn",attrs:{type:"primary",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.del(t.row.id)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.pageNo,limit:e.pageSize},on:{"update:page":function(t){e.pageNo=t},"update:limit":function(t){e.pageSize=t},pagination:e.initData}}),a("Edit",{attrs:{id:e.editId,show:e.editShow},on:{"update:show":function(t){e.editShow=t},confirm:e.handleConfirm}})],1)},n=[],s=(a("d3b7"),a("ac1f"),a("841c"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"角色",visible:e.showVal,"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.showVal=t},open:e.handleOpen,closed:e.closed}},[a("el-form",{ref:"form",attrs:{model:e.data,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称",prop:"label"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.data.label,callback:function(t){e.$set(e.data,"label",t)},expression:"data.label"}})],1),a("el-form-item",{attrs:{label:"编码",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入编码"},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}})],1),a("el-form-item",{attrs:{label:"权限"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("permission-tree",{ref:"privilegeTree",model:{value:e.data.permissions,callback:function(t){e.$set(e.data,"permissions",t)},expression:"data.permissions"}})],1),a("el-col",{attrs:{span:12}},[a("el-select",{model:{value:e.data.dataPermissionType,callback:function(t){e.$set(e.data,"dataPermissionType",t)},expression:"data.dataPermissionType"}},e._l(e.dataPermissionTypes,(function(e){return a("el-option",{key:e.name,attrs:{label:e.label,value:e.name}})})),1),a("department-tree",{directives:[{name:"show",rawName:"v-show",value:"SETTING"===e.data.dataPermissionType,expression:"data.dataPermissionType==='SETTING'"}],attrs:{"show-checkbox":!0},on:{check:e.handleCheck}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)}),o=[],r=(a("a15b"),a("3323")),l=a("6632"),c=a("f024"),d=a("3659"),u={name:"Edit",components:{PermissionTree:d["a"],DepartmentTree:c["a"]},mixins:[r["a"]],props:{},data:function(){return{loading:!1,data:{name:null,contact:null,mobile:null,permissions:null,dataPermissionType:"USER",depDataPermissions:[]},rules:{name:[{require:!0,message:"请输入编号",trigger:"blur"},{min:2,max:20,message:"长度在4-20个字符",trigger:"blur"}],label:[{require:!0,message:"请输入名称",trigger:"blur"},{min:2,max:20,message:"长度在2-20个字符",trigger:"blur"}]},dataPermissionTypes:[]}},computed:{submitData:{get:function(){var e={};return Object.assign(e,this.data),e.permissions=this.data.permissions.join(","),"SETTING"===e.dataPermissionType&&(console.log(this.data),e.depDataPermissions=this.data.depDataPermissions.join(",")),e}}},created:function(){this.initDataPermissionTypes()},methods:{submit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,e.id?Object(l["g"])({id:e.id,data:e.submitData}).then((function(){e.loading=!1,e.$message("更新成功"),e.cancel(),e.confirm()})):Object(l["f"])(e.submitData).then((function(t){e.loading=!1,e.$message("提交成功"),e.cancel(),e.confirm()}))}))},confirm:function(){this.$emit("confirm")},init:function(){var e=this;this.loading=!0,Object(l["d"])(this.id).then((function(t){e.loading=!1,e.data=t.data,e.setPermissions(e.data.permissions),console.log(e.data)}))},initDataPermissionTypes:function(){var e=this;Object(l["b"])().then((function(t){e.dataPermissionTypes=t.data}))},setPermissions:function(e){this.$refs.privilegeTree.setCheckedKeys(e)},cancel:function(){this.showVal=!1},handleOpen:function(){this.id&&this.init()},reset:function(){this.$refs.form.resetFields()},closed:function(){this.reset(),this.setPermissions([])},handleCheck:function(e,t){var a=t.checkedKeys;this.data.depDataPermissions=a}}},h=u,m=a("2877"),p=Object(m["a"])(h,s,o,!1,null,"660a2328",null),f=p.exports,b=a("333d"),g=a("6724"),v={name:"List",components:{Edit:f,Pagination:b["a"]},directives:{waves:g["a"]},data:function(){return{editShow:!1,editId:null,loading:!1,data:[],search:null,pageSize:10,pageNo:1,total:0,editPrivilege:{id:null,show:!1}}},computed:{searchParam:function(){return{search:this.search,pageNo:this.pageNo,pageSize:this.pageSize}}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0,Object(l["e"])(this.searchParam).then((function(t){e.loading=!1,e.data=t.data.data,e.total=t.data.total}))},currentChange:function(){this.initData()},sizeChange:function(){this.initData()},handleConfirm:function(){this.initData()},del:function(e){var t=this;this.$confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,Object(l["c"])(e).then((function(){t.$message({type:"success",message:"删除成功"}),t.initData()})).catch((function(e){console.error(e)})).finally((function(){t.loading=!1}))})).catch((function(){}))},add:function(){this.editId=null,this.editShow=!0},edit:function(e){this.editId=e,this.editShow=!0}}},y=v,w=(a("d89e"),Object(m["a"])(y,i,n,!1,null,"2043eaee",null));t["default"]=w.exports},d89e:function(e,t,a){"use strict";var i=a("fa37"),n=a.n(i);n.a},fa37:function(e,t,a){}}]);
//# sourceMappingURL=chunk-1dbcd6a9.3201e705.js.map