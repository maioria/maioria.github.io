(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-da5122fa"],{"119f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"tree-container"},[a("department-tree",{on:{"node-click":e.nodeClick}})],1),a("div",{staticClass:"table-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.initData}},[e._v("查询 ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.add}},[e._v("新增 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.data,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"编号",width:"70",prop:"id",align:"center"}}),a("el-table-column",{attrs:{label:"姓名",width:"100",prop:"name","show-tooltip-when-overflow":""}}),a("el-table-column",{attrs:{label:"用户名","show-tooltip-when-overflow":"",prop:"username"}}),a("el-table-column",{attrs:{width:"140","show-tooltip-when-overflow":"",label:"手机号",prop:"mobile"}}),a("el-table-column",{attrs:{label:"角色","show-overflow-tooltip":"",width:"140",prop:"roleNames","show-tooltip-when-overflow":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.roleLabels.join(",")))])]}}])}),a("el-table-column",{attrs:{width:"120",label:"部门",prop:"depName"}}),a("el-table-column",{attrs:{label:"状态","header-align":"center",align:"center",width:"75",prop:"statusName"}}),a("el-table-column",{attrs:{"header-align":"center",align:"center",width:"225","class-name":"operate-group",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.edit(t.row.id)}}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.delUser(t.row.id)}}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.resetPasswordMethod(t.row.id)}}},[e._v("重置密码 ")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.pageNo,limit:e.pageSize},on:{"update:page":function(t){e.pageNo=t},"update:limit":function(t){e.pageSize=t},pagination:e.initData}}),a("Edit",{attrs:{id:e.editId,show:e.editShow},on:{"update:show":function(t){e.editShow=t}}}),a("reset-password",{attrs:{show:e.resetPassword.show,"user-id":e.resetPassword.userId},on:{"update:show":function(t){return e.$set(e.resetPassword,"show",t)}}})],1)])},i=[],r=(a("ac1f"),a("841c"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"用户",visible:e.showVal,"append-to-body":!0,width:"40%","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.showVal=t},closed:e.closed,open:e.handleOpen}},[a("el-form",{ref:"form",attrs:{model:e.data,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}})],1),a("el-form-item",{attrs:{label:"部门",prop:"depId"}},[a("department-input",{ref:"departmentInput",model:{value:e.data.depId,callback:function(t){e.$set(e.data,"depId",t)},expression:"data.depId"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.data.username,callback:function(t){e.$set(e.data,"username",t)},expression:"data.username"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{model:{value:e.data.mobile,callback:function(t){e.$set(e.data,"mobile",t)},expression:"data.mobile"}})],1),a("el-form-item",{attrs:{label:"座机",prop:"tel"}},[a("el-input",{model:{value:e.data.tel,callback:function(t){e.$set(e.data,"tel",t)},expression:"data.tel"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.data.email,callback:function(t){e.$set(e.data,"email",t)},expression:"data.email"}})],1),a("el-form-item",{attrs:{label:"角色",prop:"roles"}},[a("el-checkbox-group",{directives:[{name:"loading",rawName:"v-loading",value:e.roleLoading,expression:"roleLoading"}],model:{value:e.data.roles,callback:function(t){e.$set(e.data,"roles",t)},expression:"data.roles"}},e._l(e.roleList,(function(t){return a("el-checkbox",{key:t.name,attrs:{label:t.name,name:"type"}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")]),a("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1)}),o=[],s=(a("a15b"),a("a9e3"),a("e181")),l=a("b15a"),d=a("6632"),u=a("a00a"),c={name:"Edit",components:{DepartmentInput:s["a"]},props:{show:{type:Boolean,default:!1},id:{type:Number,default:null}},data:function(){var e=this;return{loading:!1,roleLoading:!1,roleList:[],data:{username:"",name:"",mobile:"",tel:"",email:"",rank:"",roles:[],depId:null},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:20,message:"长度在2-10个字符",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],rank:[{type:"number",required:!0,message:"请选择岗位",trigger:"change"}],depId:[{type:"number",required:!0,message:"请选择部门",trigger:"change"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(t,a,n){Object(u["b"])(e.id,t,a,n)},trigger:"blur"}],tel:[],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:function(t,a,n){Object(u["a"])(e.id,t,a,n)},trigger:"blur"}]}}},computed:{showVal:{get:function(){return this.show},set:function(e){this.$emit("update:show",e)}},submitData:{get:function(){var e=this.data;return e.id=this.id,e.roles=this.data.roles.join(","),e}}},methods:{submit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,e.id?Object(l["h"])({id:e.id,data:e.submitData}).then((function(){e.loading=!1,e.$message("更新成功"),e.showVal=!1,e.reset()})):Object(l["g"])(e.submitData).then((function(){e.loading=!1,e.$message("提交成功"),e.showVal=!1,e.reset()}))}))},init:function(){var e=this;this.loading=!0,Object(l["d"])(this.id).then((function(t){e.loading=!1,e.data=t.data,e.$refs.departmentInput.setValue(e.data.depId)}))},initRoles:function(){var e=this;this.roleLoading=!0,Object(d["a"])().then((function(t){e.roleList=t.data,e.roleLoading=!1}))},cancel:function(){this.showVal=!1},reset:function(){this.$refs.form.resetFields()},closed:function(){this.reset()},handleOpen:function(){this.id&&this.init(this.id),this.initRoles()}}},p=c,m=a("2877"),h=Object(m["a"])(p,r,o,!1,null,"e17d7818",null),f=h.exports,b=a("f024"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"重置密码",visible:e.visibleVal,"append-to-body":!0,width:"40%"},on:{"update:visible":function(t){e.visibleVal=t}}},[a("el-form",{ref:"form",attrs:{model:e.data,"status-icon":"",rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"新密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},g=[],v={name:"ResetPassword",props:{userId:{require:!0,type:Number},show:{require:!0,type:Boolean}},data:function(){var e=function(e,t,a){a()};return{data:{password:null},rules:{password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:e,trigger:"blur"}]}}},computed:{visibleVal:{get:function(){return this.show},set:function(e){this.$emit("update:show",e)}}},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;var a={userId:e.userId,password:e.data.password};Object(l["f"])(a).then((function(t){var a=t.data;a&&!0===a?(e.$message("重置密码成功"),e.hideShowUpdPwd()):e.$message(a)}),(function(t){console.error(t),e.$message("重置密码出现问题")}))}))},close:function(){this.$refs["form"].resetFields(),this.hideShowUpdPwd()},hideShowUpdPwd:function(){this.visibleVal=!1}}},y=v,k=Object(m["a"])(y,w,g,!1,null,"809839a0",null),x=k.exports,$=a("6724"),j=a("333d"),O={name:"List",components:{Edit:f,DepartmentTree:b["a"],ResetPassword:x,Pagination:j["a"]},directives:{waves:$["a"]},data:function(){return{editShow:!1,editId:null,resetPassword:{userId:null,show:!1},loading:!1,data:[],search:null,pageSize:10,departmentId:null,pageNo:1,total:0}},computed:{searchParam:function(){return{search:this.search,depId:this.departmentId,pageNo:this.pageNo,pageSize:this.pageSize}}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;this.loading=!0,Object(l["e"])(this.searchParam).then((function(t){e.loading=!1,e.data=t.data.data,e.total=t.data.total}))},currentChange:function(){this.initData()},sizeChange:function(){this.initData()},delUser:function(e){var t=this;this.$confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["c"])(e).then((function(e){e.data?(t.$message.success("删除成功"),t.initData()):t.$message.error("删除失败，请联系管理员")})).catch((function(e){console.error(e),t.$message.error("删除失败，请联系管理员")}))})).catch((function(){}))},add:function(){this.editId=null,this.editShow=!0},edit:function(e){this.editId=e,this.editShow=!0},nodeClick:function(e){this.departmentId=e.id,this.initData()},editRole:function(e){},editDataPrivilege:function(e){},resetPasswordMethod:function(e){this.resetPassword.userId=e,this.resetPassword.show=!0}}},S=O,I=(a("b598"),Object(m["a"])(S,n,i,!1,null,"25a82ed6",null));t["default"]=I.exports},a00a:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));a("99af"),a("b0c0");var n=a("b15a");function i(e,t,a,i){Object(n["a"])({email:a,id:e}).then((function(e){var t=e.data;t?i(new Error("手机号与".concat(t.name,"-").concat(t.depName,"重复"))):i()}))}function r(e,t,a,i){Object(n["b"])({mobile:a,id:e}).then((function(e){var t=e.data;t?i(new Error("邮箱与".concat(t.name,"-").concat(t.depName,"重复"))):i()}))}},a1ea:function(e,t,a){},b15a:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"g",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return p}));var n=a("b775"),i=function(e){return Object(n["a"])({url:"/sys/user/list",method:"get",params:e})},r=function(e){return Object(n["a"])({url:"/sys/user/"+e,method:"get"})},o=function(e){return Object(n["a"])({url:"/sys/user",method:"post",data:e})},s=function(e){var t=e.id,a=e.data;return Object(n["a"])({url:"/sys/user/"+t,method:"post",data:a})},l=function(e){var t=e.id,a=e.data;return Object(n["a"])({url:"/sys/user/".concat(t,"/updAccount"),method:"post",data:a})},d=function(e){var t=e.mobile,a=e.id;return Object(n["a"])({url:"/sys/user/checkMobileExist",method:"get",params:{mobile:t,id:a}})},u=function(e){var t=e.email,a=e.id;return Object(n["a"])({url:"/sys/user/checkEmailExist",method:"get",params:{email:t,id:a}})},c=function(e){return Object(n["a"])({url:"/sys/user/"+e,method:"delete"})},p=function(e){return Object(n["a"])({url:"/sys/user/resetPassword",method:"post",params:e})}},b598:function(e,t,a){"use strict";var n=a("a1ea"),i=a.n(n);i.a},e181:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{placement:"bottom",trigger:"focus",width:"200"},on:{show:e.handleShow},model:{value:e.popoverShow,callback:function(t){e.popoverShow=t},expression:"popoverShow"}},[a("div",[a("department-tree",{ref:"departmentTree",on:{"node-click":e.nodeClick}})],1),a("el-input",{attrs:{slot:"reference",readonly:!0},slot:"reference",model:{value:e.departmentName,callback:function(t){e.departmentName=t},expression:"departmentName"}})],1)},i=[],r=(a("b0c0"),a("a9e3"),a("f024")),o=a("6018"),s={name:"DepartmentInput",components:{DepartmentTree:r["a"]},props:{value:{default:null,require:!0,type:Number}},data:function(){return{department:null,popoverShow:!1}},computed:{departmentVal:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},departmentName:function(){return this.department&&this.department.name}},methods:{nodeClick:function(e){this.department=e,this.departmentVal=this.department&&this.department.id,this.popoverShow=!1},handleShow:function(){this.$refs.departmentTree.initData()},setValue:function(e){var t=this;e?Object(o["d"])(e).then((function(e){t.department=e.data})):(this.department=null,this.departmentVal=null)}}},l=s,d=a("2877"),u=Object(d["a"])(l,n,i,!1,null,"4dc91a75",null);t["a"]=u.exports}}]);
//# sourceMappingURL=chunk-da5122fa.4a4c3c15.js.map